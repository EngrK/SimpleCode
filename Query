-- Create index on Customers table
CREATE INDEX idx_customers ON Customers (CustomerID, Cust_Name);

-- Create index on Orders table
CREATE INDEX idx_orders ON Orders (ItemID, CustomerID, OrderID);

-- Create index on Items table
CREATE INDEX idx_items ON Items (ItemID, ItemName);


SELECT DISTINCT C.Cust_Name
FROM Customers C
WHERE C.CustomerID IN (
    SELECT O.CustomerID
    FROM Orders O
    WHERE O.ItemID IN (
        SELECT I.ItemID
        FROM Items I
        WHERE I.Price > (
            SELECT I2.Price
            FROM Items I2
            JOIN Orders O2 ON I2.ItemID = O2.ItemID
            WHERE O2.CustomerID = (SELECT CustomerID FROM Customers WHERE Cust_Name = 'Badang')
        )
    )
);


SELECT 
    O.OrderID,
    O.OrderDate,
    O.ItemID,
    O.CustomerID,
    (SELECT 'Lab_OR--' || SUBSTR(O.OrderID, 4) FROM Orders) AS New_OrderID
FROM Orders O;
